(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{108:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return f}));var r=n(0),a=n.n(r);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=a.a.createContext({}),u=function(e){var t=a.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=u(e.components);return a.a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},b=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,o=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),p=u(n),b=r,f=p["".concat(o,".").concat(b)]||p[b]||d[b]||i;return n?a.a.createElement(f,s(s({ref:t},l),{},{components:n})):a.a.createElement(f,s({ref:t},l))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=b;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var l=2;l<i;l++)o[l]=n[l];return a.a.createElement.apply(null,o)}return a.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"},78:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return s})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return u}));var r=n(2),a=n(6),i=(n(0),n(108)),o={title:"Out Of Bounds",sidebar_label:"Out Of Bounds"},s={unversionedId:"security_awareness/languages/C/OutOfBounds",id:"security_awareness/languages/C/OutOfBounds",isDocsHomePage:!1,title:"Out Of Bounds",description:"Improper Restriction of Operations within the Bounds of a Memory Buffer Vulnerability",source:"@site/docs/security_awareness/languages/C/OutOfBounds.md",slug:"/security_awareness/languages/C/OutOfBounds",permalink:"/docs/security_awareness/languages/C/OutOfBounds",version:"current",sidebar_label:"Out Of Bounds",sidebar:"someSidebar",previous:{title:"Integer Overflow or Wraparound Vulnerability",permalink:"/docs/security_awareness/languages/C/IntegerOverflow"},next:{title:"Injection Attacks",permalink:"/docs/security_awareness/languages/Python/InjectionAttacks"}},c=[{value:"Description",id:"description",children:[]},{value:"Vulnerable Code Example",id:"vulnerable-code-example",children:[]},{value:"Mitigation",id:"mitigation",children:[]},{value:"Risk Assessment",id:"risk-assessment",children:[]},{value:"References",id:"references",children:[]}],l={rightToc:c};function u(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(i.b)("wrapper",Object(r.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"Improper Restriction of Operations within the Bounds of a Memory Buffer Vulnerability"),Object(i.b)("h2",{id:"description"},"Description"),Object(i.b)("p",null,"Do not make any assumptions about the size of environment variables because an adversary might have full control over the environment. If the environment variable needs to be stored, the length of the associated string should be calculated and the storage dynamically allocated"),Object(i.b)("h2",{id:"vulnerable-code-example"},"Vulnerable Code Example"),Object(i.b)("p",null,"This vulnerable code example copies the string returned by ",Object(i.b)("inlineCode",{parentName:"p"},"getenv()")," into a fixed-size buffer:"),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-c"}),'void f() {\n  char path[PATH_MAX]; /* Requires PATH_MAX to be defined */\n  strcpy(path, getenv("PATH"));\n  /* Use path */\n}\n')),Object(i.b)("p",null,"Even if your platform assumes that ",Object(i.b)("inlineCode",{parentName:"p"},"$PATH")," is defined, defines ",Object(i.b)("inlineCode",{parentName:"p"},"PATH_MAX"),", and enforces that paths not have more than PATH_MAX characters, the $PATH environment variable still is not required to have less than ",Object(i.b)("inlineCode",{parentName:"p"},"PATH_MAX")," chars. And if it has more than ",Object(i.b)("inlineCode",{parentName:"p"},"PATH_MAX")," chars, a buffer overflow will result. Also, if ",Object(i.b)("inlineCode",{parentName:"p"},"$PATH")," is not defined, then ",Object(i.b)("inlineCode",{parentName:"p"},"strcpy()")," will attempt to dereference a null pointer."),Object(i.b)("h2",{id:"mitigation"},"Mitigation"),Object(i.b)("p",null,"In this compliant solution, the ",Object(i.b)("inlineCode",{parentName:"p"},"strlen()")," function is used to calculate the size of the string, and the required space is dynamically allocated:"),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-c"}),'void f() {\n  char *path = NULL;\n  /* Avoid assuming $PATH is defined or has limited length */\n  const char *temp = getenv("PATH");\n  if (temp != NULL) {\n    path = (char*) malloc(strlen(temp) + 1);\n    if (path == NULL) {\n      /* Handle error condition */\n    } else {\n      strcpy(path, temp);\n    }\n    /* Use path */\n    free(path);\n  }\n}\n')),Object(i.b)("h2",{id:"risk-assessment"},"Risk Assessment"),Object(i.b)("p",null,"Making assumptions about the size of an environmental variable can result in a buffer overflow."),Object(i.b)("h2",{id:"references"},"References"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(r.a)({parentName:"li"},{href:"https://cwe.mitre.org/data/definitions/119.html"}),"CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(r.a)({parentName:"li"},{href:"https://wiki.sei.cmu.edu/confluence/display/c/AA.+Bibliography#AA.Bibliography-ISO-IEC9899-2011"}),"Programming Languages\u2014C, 3rd ed (ISO/IEC 9899:2011). Geneva, Switzerland: ISO, 2011."))))}u.isMDXComponent=!0}}]);
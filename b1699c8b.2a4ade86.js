(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{103:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return s})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return u}));var r=n(3),o=n(7),a=(n(0),n(127)),i={title:"Weak SSL/TLS protocols",sidebar_label:"Weak SSL/TLS protocols"},s={unversionedId:"security_awareness/languages/TypeScript/WeakSSLTLSProtocols",id:"security_awareness/languages/TypeScript/WeakSSLTLSProtocols",isDocsHomePage:!1,title:"Weak SSL/TLS protocols",description:"Description",source:"@site/docs/security_awareness/languages/TypeScript/WeakSSLTLSProtocols.md",slug:"/security_awareness/languages/TypeScript/WeakSSLTLSProtocols",permalink:"/docs/security_awareness/languages/TypeScript/WeakSSLTLSProtocols",version:"current",sidebar_label:"Weak SSL/TLS protocols",sidebar:"someSidebar",previous:{title:"Unrestricted Upload of File",permalink:"/docs/security_awareness/languages/TypeScript/UnrestrictedUploadofFile"},next:{title:"XML parsing vulnerable to XXE",permalink:"/docs/security_awareness/languages/TypeScript/xml"}},c=[{value:"Description",id:"description",children:[]},{value:"Vulnerable Code Example",id:"vulnerable-code-example",children:[{value:"https built-in module:",id:"https-built-in-module",children:[]},{value:"tls built-in module:",id:"tls-built-in-module",children:[]},{value:"request module:",id:"request-module",children:[]}]},{value:"Mitigation",id:"mitigation",children:[{value:"https built-in module:",id:"https-built-in-module-1",children:[]},{value:"tls built-in module:",id:"tls-built-in-module-1",children:[]},{value:"request module:",id:"request-module-1",children:[]}]},{value:"Risk Assessment",id:"risk-assessment",children:[]},{value:"References",id:"references",children:[]}],l={rightToc:c};function u(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(a.b)("wrapper",Object(r.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("h2",{id:"description"},"Description"),Object(a.b)("p",null,'Older versions of SSL/TLS protocol like "SSLv3" have been proven to be insecure.'),Object(a.b)("p",null,'This rule raises an issue when an SSL/TLS context is created with an insecure protocol version (ie: a protocol different from "TLSv1.2", "TLSv1.3", "DTLSv1.2" or "DTLSv1.3"). '),Object(a.b)("h2",{id:"vulnerable-code-example"},"Vulnerable Code Example"),Object(a.b)("p",null,"secureProtocol, minVersion/maxVersion and secureOptions should not be set to use weak TLS protocols (TLSv1.1 and lower):"),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-javascript"}),"let options = {\n  secureProtocol: 'TLSv1_method' // Noncompliant: TLS1.0 is insecure\n};\n\nlet options = {\n  minVersion: 'TLSv1.1',  // Noncompliant: TLS1.1 is insecure\n  maxVersion: 'TLSv1.2'\n};\n\nlet options = {\n  secureOptions: constants.SSL_OP_NO_SSLv2 | constants.SSL_OP_NO_SSLv3 | constants.SSL_OP_NO_TLSv1\n}; // Noncompliant TLS 1.1 (constants.SSL_OP_NO_TLSv1_1) is not disabled\n")),Object(a.b)("h3",{id:"https-built-in-module"},"https built-in module:"),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-java"}),"let req = https.request(options, (res) => {\n  res.on('data', (d) => {\n    process.stdout.write(d);\n  });\n});  // Noncompliant\n")),Object(a.b)("h3",{id:"tls-built-in-module"},"tls built-in module:"),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-javascript"}),'let socket = tls.connect(443, "www.example.com", options, () => { });  // Noncompliant\n')),Object(a.b)("h3",{id:"request-module"},"request module:"),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-javascript"}),"let socket = request.get(options);\n")),Object(a.b)("h2",{id:"mitigation"},"Mitigation"),Object(a.b)("p",null,"Set either secureProtocol or secureOptions or minVersion to use secure protocols only (TLSv1.2 and higher):"),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-javascript"}),"let options = {\n  secureProtocol: 'TLSv1_2_method'\n};\n// or\nlet options = {\n  secureOptions: constants.SSL_OP_NO_SSLv2 | constants.SSL_OP_NO_SSLv3 | constants.SSL_OP_NO_TLSv1 | constants.SSL_OP_NO_TLSv1_1\n};\n// or\nlet options = {\n    minVersion: 'TLSv1.2'\n};\n")),Object(a.b)("h3",{id:"https-built-in-module-1"},"https built-in module:"),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-java"}),"let req = https.request(options, (res) => {\n  res.on('data', (d) => {\n    process.stdout.write(d);\n  });\n});  // Compliant\n")),Object(a.b)("h3",{id:"tls-built-in-module-1"},"tls built-in module:"),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-java"}),'let socket = tls.connect(443, "www.example.com", options, () => { });\n')),Object(a.b)("h3",{id:"request-module-1"},"request module:"),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-java"}),"let socket = request.get(options);\n")),Object(a.b)("h2",{id:"risk-assessment"},"Risk Assessment"),Object(a.b)("p",null,"The impact of this vulnerability is high, supposed code can be executed in the server context or on the client side. The likelihood of detection for the attacker is high. The prevalence is common. As a result the severity of this type of vulnerability is high.\nIt is important to check a file upload module\u2019s access controls to examine the risks properly.\nServer-side attacks: The web server can be compromised by uploading and executing a web-shell which can run commands, browse system files, browse local resources, attack other servers, or exploit the local vulnerabilities, and so forth."),Object(a.b)("h2",{id:"references"},"References"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",Object(r.a)({parentName:"li"},{href:"https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure.html"}),"OWASP Top 10 2017 Category A3 - Sensitive Data Exposure")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",Object(r.a)({parentName:"li"},{href:"https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html"}),"OWASP Top 10 2017 Category A6 - Security Misconfiguration")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",Object(r.a)({parentName:"li"},{href:"https://cwe.mitre.org/data/definitions/326.html"}),"MITRE, CWE-327 - Inadequate Encryption Strength")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",Object(r.a)({parentName:"li"},{href:"https://cwe.mitre.org/data/definitions/327.html"}),"MITRE, CWE-326 - Use of a Broken or Risky Cryptographic Algorithm")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",Object(r.a)({parentName:"li"},{href:"https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices#22-use-secure-protocols"}),"SSL and TLS Deployment Best Practices - Use secure protocols"))))}u.isMDXComponent=!0},127:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}));var r=n(0),o=n.n(r);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=o.a.createContext({}),u=function(e){var t=o.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=u(e.components);return o.a.createElement(l.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},d=o.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,i=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),p=u(n),d=r,m=p["".concat(i,".").concat(d)]||p[d]||b[d]||a;return n?o.a.createElement(m,s(s({ref:t},l),{},{components:n})):o.a.createElement(m,s({ref:t},l))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var l=2;l<a;l++)i[l]=n[l];return o.a.createElement.apply(null,i)}return o.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);